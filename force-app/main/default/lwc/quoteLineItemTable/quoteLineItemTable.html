<!--
  @description       : 
  @author            : ChangeMeIn@UserSettingsUnder.SFDoc
  @group             : 
  @last modified on  : 09-29-2025
  @last modified by  : ChangeMeIn@UserSettingsUnder.SFDoc
-->
<template>
    <div class="slds-card">
        <div class="slds-card__header slds-grid">
            <header class="slds-media slds-media_center slds-has-flexi-truncate">
                <div class="slds-media__body">
                    <h2 class="slds-card__header-title">
                        <span class="slds-text-heading_small">{familyFilter}</span>
                    </h2>
                </div>
            </header>
        </div>
        
        <div class="slds-card__body slds-card__body_inner">
            <!-- Loading Spinner -->
            <template lwc:if={isLoading}>
                <div class="slds-text-align_center slds-m-vertical_medium">
                    <lightning-spinner alternative-text="Loading quote line items..."></lightning-spinner>
                </div>
            </template>

            <!-- Error Message -->
            <template lwc:if={error}>
                <div class="slds-notify slds-notify_alert slds-theme_error" role="alert">
                    <span class="slds-assistive-text">Error</span>
                    <h2>Error loading quote line items: {error.body.message}</h2>
                </div>
            </template>

            <!-- Data Table -->
            <template lwc:if={hasData}>
                <table class="slds-table slds-table_cell-buffer slds-table_bordered slds-table_col-bordered">
                    <thead>
                        <tr class="slds-line-height_reset">
                            <template lwc:if={field1}>
                                <th class="slds-text-title_caps table-header" scope="col">
                                    <div class="slds-truncate" title={field1Label}>
                                        {field1Label}
                                    </div>
                                </th>
                            </template>
                            <template lwc:if={field2}>
                                <th class="slds-text-title_caps table-header" scope="col">
                                    <div class="slds-truncate" title={field2Label}>
                                        {field2Label}
                                    </div>
                                </th>
                            </template>
                            <template lwc:if={field3}>
                                <th class="slds-text-title_caps table-header" scope="col">
                                    <div class="slds-truncate" title={field3Label}>
                                        {field3Label}
                                    </div>
                                </th>
                            </template>
                            <template lwc:if={field4}>
                                <th class="slds-text-title_caps table-header" scope="col">
                                    <div class="slds-truncate" title={field4Label}>
                                        {field4Label}
                                    </div>
                                </th>
                            </template>
                            <template lwc:if={field5}>
                                <th class="slds-text-title_caps table-header" scope="col">
                                    <div class="slds-truncate" title={field5Label}>
                                        {field5Label}
                                    </div>
                                </th>
                            </template>
                        </tr>
                    </thead>
                    <tbody>
                        <template for:each={quoteLineItems} for:item="item">
                            <tr key={item.Id} class="slds-hint-parent">
                                <template lwc:if={field1}>
                                    <td class="table-cell">
                                        <div class="slds-truncate">
                                            <template lwc:if={field1IsCurrency}>
                                                <lightning-formatted-number 
                                                    value={item.field0} 
                                                    format-style="currency"
                                                    currency-code="USD"
                                                    minimum-fraction-digits="2">
                                                </lightning-formatted-number>
                                            </template>
                                            <template lwc:elseif={field1IsPercent}>
                                                <lightning-formatted-number 
                                                    value={item.field0} 
                                                    format-style="percent"
                                                    minimum-fraction-digits="2">
                                                </lightning-formatted-number>
                                            </template>
                                            <template lwc:elseif={field1IsNumber}>
                                                <lightning-formatted-number 
                                                    value={item.field0}
                                                    minimum-fraction-digits="0">
                                                </lightning-formatted-number>
                                            </template>
                                            <template lwc:elseif={field1IsDate}>
                                                <lightning-formatted-date-time 
                                                    value={item.field0}
                                                    year="numeric" 
                                                    month="short" 
                                                    day="2-digit">
                                                </lightning-formatted-date-time>
                                            </template>
                                            <template lwc:else>
                                                <lightning-formatted-text value={item.field0}></lightning-formatted-text>
                                            </template>
                                        </div>
                                    </td>
                                </template>
                                <template lwc:if={field2}>
                                    <td class="table-cell">
                                        <div class="slds-truncate">
                                            <template lwc:if={field2IsCurrency}>
                                                <lightning-formatted-number 
                                                    value={item.field1} 
                                                    format-style="currency"
                                                    currency-code="USD"
                                                    minimum-fraction-digits="2">
                                                </lightning-formatted-number>
                                            </template>
                                            <template lwc:elseif={field2IsPercent}>
                                                <lightning-formatted-number 
                                                    value={item.field1} 
                                                    format-style="percent"
                                                    minimum-fraction-digits="2">
                                                </lightning-formatted-number>
                                            </template>
                                            <template lwc:elseif={field2IsNumber}>
                                                <lightning-formatted-number 
                                                    value={item.field1}
                                                    minimum-fraction-digits="0">
                                                </lightning-formatted-number>
                                            </template>
                                            <template lwc:elseif={field2IsDate}>
                                                <lightning-formatted-date-time 
                                                    value={item.field1}
                                                    year="numeric" 
                                                    month="short" 
                                                    day="2-digit">
                                                </lightning-formatted-date-time>
                                            </template>
                                            <template lwc:else>
                                                <lightning-formatted-text value={item.field1}></lightning-formatted-text>
                                            </template>
                                        </div>
                                    </td>
                                </template>
                                <template lwc:if={field3}>
                                    <td class="table-cell">
                                        <div class="slds-truncate">
                                            <template lwc:if={field3IsCurrency}>
                                                <lightning-formatted-number 
                                                    value={item.field2} 
                                                    format-style="currency"
                                                    currency-code="USD"
                                                    minimum-fraction-digits="2">
                                                </lightning-formatted-number>
                                            </template>
                                            <template lwc:elseif={field3IsPercent}>
                                                <lightning-formatted-number 
                                                    value={item.field2} 
                                                    format-style="percent"
                                                    minimum-fraction-digits="2">
                                                </lightning-formatted-number>
                                            </template>
                                            <template lwc:elseif={field3IsNumber}>
                                                <lightning-formatted-number 
                                                    value={item.field2}
                                                    minimum-fraction-digits="0">
                                                </lightning-formatted-number>
                                            </template>
                                            <template lwc:elseif={field3IsDate}>
                                                <lightning-formatted-date-time 
                                                    value={item.field2}
                                                    year="numeric" 
                                                    month="short" 
                                                    day="2-digit">
                                                </lightning-formatted-date-time>
                                            </template>
                                            <template lwc:else>
                                                <lightning-formatted-text value={item.field2}></lightning-formatted-text>
                                            </template>
                                        </div>
                                    </td>
                                </template>
                                <template lwc:if={field4}>
                                    <td class="table-cell">
                                        <div class="slds-truncate">
                                            <template lwc:if={field4IsCurrency}>
                                                <lightning-formatted-number 
                                                    value={item.field3} 
                                                    format-style="currency"
                                                    currency-code="USD"
                                                    minimum-fraction-digits="2">
                                                </lightning-formatted-number>
                                            </template>
                                            <template lwc:elseif={field4IsPercent}>
                                                <lightning-formatted-number 
                                                    value={item.field3} 
                                                    format-style="percent"
                                                    minimum-fraction-digits="2">
                                                </lightning-formatted-number>
                                            </template>
                                            <template lwc:elseif={field4IsNumber}>
                                                <lightning-formatted-number 
                                                    value={item.field3}
                                                    minimum-fraction-digits="0">
                                                </lightning-formatted-number>
                                            </template>
                                            <template lwc:elseif={field4IsDate}>
                                                <lightning-formatted-date-time 
                                                    value={item.field3}
                                                    year="numeric" 
                                                    month="short" 
                                                    day="2-digit">
                                                </lightning-formatted-date-time>
                                            </template>
                                            <template lwc:else>
                                                <lightning-formatted-text value={item.field3}></lightning-formatted-text>
                                            </template>
                                        </div>
                                    </td>
                                </template>
                                <template lwc:if={field5}>
                                    <td class="table-cell">
                                        <div class="slds-truncate">
                                            <template lwc:if={field5IsCurrency}>
                                                <lightning-formatted-number 
                                                    value={item.field4} 
                                                    format-style="currency"
                                                    currency-code="USD"
                                                    minimum-fraction-digits="2">
                                                </lightning-formatted-number>
                                            </template>
                                            <template lwc:elseif={field5IsPercent}>
                                                <lightning-formatted-number 
                                                    value={item.field4} 
                                                    format-style="percent"
                                                    minimum-fraction-digits="2">
                                                </lightning-formatted-number>
                                            </template>
                                            <template lwc:elseif={field5IsNumber}>
                                                <lightning-formatted-number 
                                                    value={item.field4}
                                                    minimum-fraction-digits="0">
                                                </lightning-formatted-number>
                                            </template>
                                            <template lwc:elseif={field5IsDate}>
                                                <lightning-formatted-date-time 
                                                    value={item.field4}
                                                    year="numeric" 
                                                    month="short" 
                                                    day="2-digit">
                                                </lightning-formatted-date-time>
                                            </template>
                                            <template lwc:else>
                                                <lightning-formatted-text value={item.field4}></lightning-formatted-text>
                                            </template>
                                        </div>
                                    </td>
                                </template>
                            </tr>
                        </template>
                    </tbody>
                </table>
            </template>

            <!-- No Data Message -->
            <template lwc:if={configuredFields}>
                <template lwc:if={isLoading}>
                    <!-- Loading is shown above -->
                </template>
                <template lwc:elseif={error}>
                    <!-- Error is shown above -->
                </template>
                <template lwc:elseif={hasData}>
                    <!-- Data is shown above -->
                </template>
                <template lwc:else>
                    <div class="slds-text-align_center slds-m-vertical_medium">
                        <p class="slds-text-body_regular">No quote line items found.</p>
                    </div>
                </template>
            </template>

            <!-- Configuration Message -->
            <template lwc:else>
                <div class="slds-text-align_center slds-m-vertical_medium">
                    <p class="slds-text-body_regular">Please configure at least one field to display in the component properties.</p>
                </div>
            </template>
        </div>
    </div>
</template>